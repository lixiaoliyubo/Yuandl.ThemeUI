name: Auto Draft Release

on:  # 触发规则 [^1]
  push:
    tags: ['v*']
    branches: ['main', 'master']

jobs:
  create-release:
    runs-on: ubuntu-latest
    permissions:  # 必要操作权限 [^2]
      contents: write
      id-token: write

    steps:
      - uses: actions/checkout@v4
      
      - name: Extract Version
        id: version
        run: |
          VERSION="${GITHUB_REF#refs/tags/}"
          echo "version=${VERSION/v/}" >> $GITHUB_OUTPUT

      - name: Auto Draft Release
        uses: softprops/action-gh-release@v2
        with:  # 自动创建草稿版发行 [^6]
          tag_name: ${{ github.ref }}
          name: "Release ${{ steps.version.outputs.version }}"
          draft: true
          prerelease: false
